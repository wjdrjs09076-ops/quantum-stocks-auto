update.R
pkgs <- c("tidyverse","lubridate","tidyquant","writexl","readr")
new_pkgs <- pkgs[!(pkgs %in% installed.packages()[, "Package"])]
if(length(new_pkgs)>0) install.packages(new_pkgs)

library(tidyverse); library(lubridate); library(tidyquant); library(writexl); library(readr)

tickers <- tibble::tribble(
  ~name, ~symbol,
  "QSI (Quantum-Si)", "QSI",
  "QBTS (D-Wave)",    "QBTS",
  "IONQ (IonQ)",      "IONQ",
  "RGTI (Rigetti)",   "RGTI",
  "QTUM (Quantum ETF)","QTUM"
)

end_date   <- Sys.Date()
start_date <- end_date - 365

prices_raw <- tq_get(tickers$symbol, from=start_date, to=end_date, get="stock.prices")
stopifnot(!is.null(prices_raw), nrow(prices_raw) > 0)

prices <- prices_raw %>%
  select(symbol, date, open, high, low, close, volume) %>%
  left_join(tickers, by="symbol") %>%
  arrange(date, name)

close_pivot <- prices %>%
  select(date, name, close) %>%
  pivot_wider(names_from=name, values_from=close) %>%
  arrange(date)

index_pivot <- prices %>%
  group_by(name) %>% arrange(date) %>%
  mutate(index_100 = close/first(close)*100) %>%
  ungroup() %>%
  select(date, name, index_100) %>%
  pivot_wider(names_from=name, values_from=index_100) %>%
  arrange(date)

dir.create("public", showWarnings = FALSE)

write_xlsx(
  list(close_pivot=close_pivot, index_pivot=index_pivot, prices_long=prices),
  path = "public/quantum_latest.xlsx"
)
public/index.html
write_csv(close_pivot, "public/quantum_close_pivot.csv")
<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <title>Quantum Stocks Auto</title>
</head>
<body>
  <h1>Quantum Stocks (최근 1년) 자동 업데이트</h1>
  <ul>
    <li><a href="quantum_latest.xlsx">엑셀 다운로드 (.xlsx)</a></li>
    <li><a href="quantum_close_pivot.csv">CSV 다운로드 (피벗)</a></li>
  </ul>
  <p>GitHub Actions로 주기적으로 업데이트됩니다.</p>
</body>
</html>
.github/workflows/update.yml
name: Update quantum data

on:
  schedule:
    - cron: "*/5 * * * *"   # ✅ 5분마다
  workflow_dispatch:

permissions:
  contents: write

jobs:
  run:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - uses: r-lib/actions/setup-r@v2

      - name: Run updater
        run: Rscript update.R

      - name: Commit & push
        run: |
          git config user.name "github-actions"
          git config user.email "actions@github.com"
          git add public/quantum_latest.xlsx public/quantum_close_pivot.csv public/last_updated.txt
          git commit -m "auto: update data" || echo "No changes"
          git push
